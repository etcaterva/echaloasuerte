{% extends "base.html" %}
{% load url from future %}
{% load i18n %}
{% block extra_jq_ready %}
    $('.data-table').DataTable(
        {
            "language" : {
                "emptyTable":     "{% trans 'No data available in table'%}",
                "info":           "{% trans 'Showing _START_ to _END_ of _TOTAL_ entries'%}",
                "infoEmpty":      "{% trans 'Showing 0 to 0 of 0 entries'%}",
                "infoFiltered":   "{% trans '(filtered from _MAX_ total entries)'%}",
                "thousands":      "{% trans ','%}",
                "lengthMenu":     "{% trans 'Show _MENU_ entries'%}",
                "loadingRecords": "{% trans 'Loading...'%}",
                "processing":     "{% trans 'Processing...'%}",
                "search":         "{% trans 'Search:'%}",
                "zeroRecords":    "{% trans 'No matching records found'%}",
                "paginate": {
                    "first":      "{% trans 'First'%}",
                    "last":       "{% trans 'Last'%}",
                    "next":       "{% trans 'Next'%}",
                    "previous":   "{% trans 'Previous'%}"
                },
                "aria": {
                    "sortAscending":  "{% trans ': activate to sort column ascending'%}",
                    "sortDescending": "{% trans ': activate to sort column descending'%}"
                }
            },
            "order": [[ 1, "desc" ]]
        }
    );

    $('.data-table').on( 'click', 'tr', function () {
        if(!($(this).attr('alt')))
            return true;

        window.location = $(this).attr('alt');
    } );

{% endblock extra_jq_ready %}

{% block content %}
    <div id="profile">
        <h1>{{user}}</h1>
        {%if draws.owner %}<h3>{% trans "Draws" %}:</h3>{% endif %}
        <table class="data-table" width="100%" cellspacing="0">
            <thead>
                <tr>
                    <th>{%trans 'Draw Name' %}</th>
                    <th>{%trans 'Created on' %}</th>
                    <th>{%trans '# results' %}</th>
                </tr>
            </thead>
            <tbody>
            {% for d in draws.owner reversed%}
                <tr alt="{% url 'retrieve_draw' draw_id=d.pk %}" style="cursor: pointer;">
                    <td>{{ d.title|default:d.DEFAULT_TITLE }}</td>
                    <td>{{d.creation_time|date:" Y/m/d G:i:s "}}</td>
                    <td>{{d.results | length}}</td>
                </tr>
            {% endfor %}
            </tbody>
        </table>
        <hr/>
        <a href="{% url 'login' %}"><button type="button" class="btn">Logout</button></a>
    </div>
{% endblock %}
